const jwtSecret="JOB",jwt=require("jsonwebtoken"),passport=require("passport");require("./passport.js");let generateJWTToken=s=>jwt.sign(s,"JOB",{subject:s.Username,expiresIn:"7d",algorithm:"HS256"});module.exports=s=>{s.post("/api/user/login",(s,e)=>{passport.authenticate("local",{session:!1},(t,n,o)=>{if(t||!n)return e.status(400).json({message:"Something is not right",user:n});s.login(n,{session:!1},s=>{s&&e.send(s);let t=generateJWTToken(n.toJSON());return e.json({user:n,token:t})})})(s,e)})};