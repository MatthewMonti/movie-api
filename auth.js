var jwtSecret="JOB",jwt=require("jsonwebtoken"),passport=require("passport");require("./passport.js");var generateJWTToken=function e(t){return jwt.sign(t,jwtSecret,{subject:t.Username,expiresIn:"7d",algorithm:"HS256"})};module.exports=function(e){e.post("/api/user/login",function(e,t){passport.authenticate("local",{session:!1},function(n,s,o){if(n||!s)return t.status(400).json({message:"Something is not right",user:s});e.login(s,{session:!1},function(e){e&&t.send(e);var n=generateJWTToken(s.toJSON());return t.json({user:s,token:n})})})(e,t)})};